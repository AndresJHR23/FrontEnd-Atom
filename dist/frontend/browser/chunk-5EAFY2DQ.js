import{A as V,B as A,C as H,D as $,E as J,F as K,G as Q,b as w,d as f,f as y,g as P,j as D,k as O,l as T,m as U,o as B,p as L,q as j,r as N,s as k,t as z,u as G,v as R,w as q}from"./chunk-CGF5XR5Z.js";import{$ as S,W as x,ba as E,ca as F,fa as I,h as _}from"./chunk-A5E56M6Z.js";import{Gb as m,Nb as C,Sa as a,Ta as l,ha as h,hb as u,hc as v,jb as s,kc as b,pb as o,qb as n,rb as g,wb as M}from"./chunk-NCZMGGES.js";function W(i,c){i&1&&(o(0,"mat-error"),m(1," El email es requerido "),n())}function X(i,c){i&1&&(o(0,"mat-error"),m(1," Ingresa un email v\xE1lido "),n())}function Y(i,c){i&1&&g(0,"mat-spinner",9)}function Z(i,c){i&1&&(o(0,"span"),m(1,"Ingresar"),n())}var be=(()=>{class i{constructor(t,e,r,d,p){this.fb=t,this.userService=e,this.router=r,this.dialog=d,this.snackBar=p,this.loading=!1}ngOnInit(){this.initForm()}initForm(){this.loginForm=this.fb.group({email:["",[f.required,f.email]]})}onSubmit(){if(this.loginForm.valid){this.loading=!0;let t=this.loginForm.value.email;this.userService.findByEmail(t).subscribe({next:e=>{this.loading=!1,e?(this.userService.setCurrentUser(e),this.router.navigate(["/tasks"]),this.showMessage("\xA1Bienvenido de vuelta!")):this.showCreateUserDialog(t)},error:e=>{this.loading=!1,this.showMessage("Error al verificar usuario"),console.error("Error:",e)}})}}showCreateUserDialog(t){this.dialog.open(Q,{width:"400px",data:{title:"Usuario no encontrado",message:`El usuario con email ${t} no existe. \xBFDeseas crear una nueva cuenta?`,confirmText:"Crear usuario",cancelText:"Cancelar"}}).afterClosed().subscribe(r=>{r&&this.createUser(t)})}createUser(t){this.loading=!0,this.userService.createUser({email:t}).subscribe({next:e=>{this.loading=!1,this.router.navigate(["/tasks"]),this.showMessage("\xA1Usuario creado exitosamente!")},error:e=>{this.loading=!1,this.showMessage("Error al crear usuario"),console.error("Error:",e)}})}showMessage(t){this.snackBar.open(t,"Cerrar",{duration:3e3,horizontalPosition:"center",verticalPosition:"top"})}static{this.\u0275fac=function(e){return new(e||i)(l(U),l(I),l(_),l(x),l(F))}}static{this.\u0275cmp=h({type:i,selectors:[["app-login"]],standalone:!0,features:[C],decls:19,vars:6,consts:[[1,"login-container"],[1,"login-card"],[3,"ngSubmit","formGroup"],["appearance","outline",1,"full-width"],["matInput","","type","email","formControlName","email","placeholder","tu@email.com"],[4,"ngIf"],[1,"button-container"],["mat-raised-button","","color","primary","type","submit",1,"login-button",3,"disabled"],["diameter","20",4,"ngIf"],["diameter","20"]],template:function(e,r){if(e&1&&(o(0,"div",0)(1,"mat-card",1)(2,"mat-card-header")(3,"mat-card-title"),m(4,"Iniciar Sesi\xF3n"),n(),o(5,"mat-card-subtitle"),m(6,"Ingresa tu email para continuar"),n()(),o(7,"mat-card-content")(8,"form",2),M("ngSubmit",function(){return r.onSubmit()}),o(9,"mat-form-field",3)(10,"mat-label"),m(11,"Email"),n(),g(12,"input",4),u(13,W,2,0,"mat-error",5)(14,X,2,0,"mat-error",5),n(),o(15,"div",6)(16,"button",7),u(17,Y,1,0,"mat-spinner",8)(18,Z,2,0,"span",5),n()()()()()()),e&2){let d,p;a(8),s("formGroup",r.loginForm),a(5),s("ngIf",(d=r.loginForm.get("email"))==null?null:d.hasError("required")),a(),s("ngIf",(p=r.loginForm.get("email"))==null?null:p.hasError("email")),a(2),s("disabled",!r.loginForm.valid||r.loading),a(),s("ngIf",r.loading),a(),s("ngIf",!r.loading)}},dependencies:[b,v,B,D,w,y,P,O,T,G,L,N,z,k,j,A,V,R,q,$,H,E,S,K,J],styles:[".login-container[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;min-height:100vh;padding:20px;background:linear-gradient(135deg,#667eea,#764ba2)}.login-card[_ngcontent-%COMP%]{width:100%;max-width:400px;padding:20px;border-radius:12px;box-shadow:0 8px 32px #0000001a}.full-width[_ngcontent-%COMP%]{width:100%;margin-bottom:16px}.button-container[_ngcontent-%COMP%]{display:flex;justify-content:center;margin-top:20px}.login-button[_ngcontent-%COMP%]{width:100%;height:48px;font-size:16px;font-weight:500}mat-card-header[_ngcontent-%COMP%]{text-align:center;margin-bottom:20px}mat-card-title[_ngcontent-%COMP%]{font-size:24px;font-weight:600;color:#333}mat-card-subtitle[_ngcontent-%COMP%]{font-size:14px;color:#666;margin-top:8px}"]})}}return i})();export{be as LoginComponent};
